<!DOCTYPE html>
<html lang="es" class="h-full bg-white dark:bg-gray-900">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Padel App{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
</head>
<body class="h-full dark:bg-gray-900 transition-colors duration-300">
    <!-- Theme Toggle -->
    <div class="fixed top-4 right-4 z-50">
        <button id="themeToggle" class="p-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-100 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
            <span class="dark:hidden">üåô</span>
            <span class="hidden dark:inline">‚òÄÔ∏è</span>
        </button>
    </div>

    <!-- Navigation -->
    <nav class="bg-blue-600 dark:bg-blue-800 shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <a href="{% url 'home' %}" class="flex-shrink-0 text-white font-bold text-xl hover:text-blue-100 transition-colors">
                        üéæ Padel App
                    </a>
                    <div class="hidden md:ml-6 md:flex md:space-x-4">
                        {% if user.is_authenticated %}
                            <a href="{% url 'home' %}" class="text-white hover:bg-blue-700 dark:hover:bg-blue-600 px-3 py-2 rounded-md transition-colors">Inicio</a>
                            <a href="{% url 'perfil' %}" class="text-white hover:bg-blue-700 dark:hover:bg-blue-600 px-3 py-2 rounded-md transition-colors">Perfil</a>
                            {% if user.rol == 'Alumno_Usuario' %}
                                <a href="{% url 'lista_espera' %}" class="text-white hover:bg-blue-700 dark:hover:bg-blue-600 px-3 py-2 rounded-md transition-colors">Lista de Espera</a>
                            {% elif user.rol == 'Profesor_Admin' %}
                                <a href="{% url 'gestion_alumnos' %}" class="text-white hover:bg-blue-700 dark:hover:bg-blue-600 px-3 py-2 rounded-md transition-colors">Gesti√≥n Alumnos</a>
                                <a href="{% url 'gestion_espera' %}" class="text-white hover:bg-blue-700 dark:hover:bg-blue-600 px-3 py-2 rounded-md transition-colors">Gesti√≥n Espera</a>
                                <a href="{% url 'emparejamiento' %}" class="text-white hover:bg-blue-700 dark:hover:bg-blue-600 px-3 py-2 rounded-md transition-colors">Emparejamiento</a>
                                <a href="{% url 'lista_clases' %}" class="text-white hover:bg-blue-700 dark:hover:bg-blue-600 px-3 py-2 rounded-md transition-colors">Gesti√≥n Clases</a>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    {% if user.is_authenticated %}
                        <span class="text-white dark:text-blue-100">Hola, {{ user.nombre }}</span>
                        <form method="post" action="{% url 'logout' %}" class="inline">
                            {% csrf_token %}
                            <button type="submit" class="text-white hover:bg-blue-700 dark:hover:bg-blue-600 px-3 py-2 rounded-md transition-colors">Cerrar Sesi√≥n</button>
                        </form>
                    {% else %}
                        <a href="{% url 'login' %}" class="text-white hover:bg-blue-700 dark:hover:bg-blue-600 px-3 py-2 rounded-md transition-colors">Iniciar Sesi√≥n</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </nav>

    <!-- Messages - MEJORADO Y CORREGIDO -->
    {% if messages %}
    <div class="max-w-4xl mx-auto mt-4 px-4">
        {% for message in messages %}
        <div class="flex items-start p-4 rounded-lg mb-4 border transition-all duration-300 transform hover:scale-[1.02]
                    {% if message.tags == 'success' %}
                        bg-green-50 dark:bg-green-900/30 text-green-800 dark:text-green-200 border-green-200 dark:border-green-700
                    {% elif message.tags == 'error' %}
                        bg-red-50 dark:bg-red-900/30 text-red-800 dark:text-red-200 border-red-200 dark:border-red-700
                    {% elif message.tags == 'warning' %}
                        bg-yellow-50 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200 border-yellow-200 dark:border-yellow-700
                    {% else %}
                        bg-blue-50 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 border-blue-200 dark:border-blue-700
                    {% endif %}">
            
            <!-- Icono seg√∫n el tipo de mensaje -->
            <div class="flex-shrink-0 mr-3 mt-0.5">
                {% if message.tags == 'success' %}
                    <span class="text-lg">‚úÖ</span>
                {% elif message.tags == 'error' %}
                    <span class="text-lg">‚ùå</span>
                {% elif message.tags == 'warning' %}
                    <span class="text-lg">‚ö†Ô∏è</span>
                {% else %}
                    <span class="text-lg">‚ÑπÔ∏è</span>
                {% endif %}
            </div>
            
            <!-- Contenido del mensaje -->
            <div class="flex-1">
                <p class="font-medium {% if message.tags == 'success' %}text-green-900 dark:text-green-100
                                  {% elif message.tags == 'error' %}text-red-900 dark:text-red-100
                                  {% elif message.tags == 'warning' %}text-yellow-900 dark:text-yellow-100
                                  {% else %}text-blue-900 dark:text-blue-100{% endif %}">
                    {{ message }}
                </p>
            </div>
            
            <!-- Bot√≥n para cerrar -->
            <button type="button" class="flex-shrink-0 ml-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors"
                    onclick="this.parentElement.style.display='none'">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
        {% block content %}
        {% endblock %}
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 dark:bg-gray-900 text-white mt-12 border-t border-gray-700 dark:border-gray-800">
        <div class="max-w-7xl mx-auto py-6 px-4 text-center">
            <p class="text-gray-300 dark:text-gray-400">&copy; 2024 Padel App. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script>
        // Theme Toggle
        const themeToggle = document.getElementById('themeToggle');
        const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
        
        // Set initial theme
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
            document.documentElement.classList.toggle('dark', savedTheme === 'dark');
        } else {
            // Si no hay tema guardado, usar la preferencia del sistema
            const isDark = prefersDarkScheme.matches;
            document.documentElement.classList.toggle('dark', isDark);
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        }
        
        themeToggle.addEventListener('click', () => {
            const isDark = document.documentElement.classList.toggle('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            
            // Agregar feedback visual
            themeToggle.classList.add('scale-90');
            setTimeout(() => {
                themeToggle.classList.remove('scale-90');
            }, 150);
        });

        // Auto-ocultar mensajes despu√©s de 8 segundos
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                const messages = document.querySelectorAll('.max-w-4xl > div');
                messages.forEach(function(message) {
                    message.style.opacity = '0';
                    message.style.transition = 'opacity 0.5s ease';
                    setTimeout(() => {
                        if (message.parentElement) {
                            message.style.display = 'none';
                        }
                    }, 500);
                });
            }, 8000);
        });

        // Mejorar la experiencia del tema
        document.documentElement.style.setProperty('--scrollbar-width', (window.innerWidth - document.documentElement.clientWidth) + 'px');
    </script>

    <style>
        /* Scrollbar personalizado para dark mode */
        .dark ::-webkit-scrollbar {
            width: 8px;
        }
        .dark ::-webkit-scrollbar-track {
            background: #1f2937;
        }
        .dark ::-webkit-scrollbar-thumb {
            background: #4b5563;
            border-radius: 4px;
        }
        .dark ::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }
        
        /* Transiciones suaves para todos los elementos */
        * {
            transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease;
        }
    </style>
</body>
</html>